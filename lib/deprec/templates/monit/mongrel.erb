
check process mongrel_<%= @username %>_5000
  with pidfile /data/<%= @username %>/shared/log/mongrel.5000.pid
  start program = "/usr/bin/mongrel_rails cluster::start -C /data/<%= @username %>/current/config/mongrel_cluster.yml --clean --only 5000"
  stop program = "/usr/bin/mongrel_rails cluster::stop -C /data/<%= @username %>/current/config/mongrel_cluster.yml --clean --only 5000"
  if totalmem is greater than 110.0 MB for 1 cycles then restart       # eating up memory?
  if cpu is greater than 50% for 2 cycles then alert                  # send an email to admin
  if cpu is greater than 80% for 3 cycles then restart                # hung process?
  if loadavg(5min) greater than 10 for 8 cycles then restart          # bad, bad, bad
  if 20 restarts within 20 cycles then timeout                         # something is wrong, call the sys-admin
  group mongrel

check process mongrel_<%= @username %>_5001
  with pidfile /data/<%= @username %>/shared/log/mongrel.5001.pid
  start program = "/usr/bin/mongrel_rails cluster::start -C /data/<%= @username %>/current/config/mongrel_cluster.yml --clean --only 5001"
  stop program = "/usr/bin/mongrel_rails cluster::stop -C /data/<%= @username %>/current/config/mongrel_cluster.yml --clean --only 5001"
  if totalmem is greater than 110.0 MB for 1 cycles then restart       # eating up memory?
  if cpu is greater than 50% for 2 cycles then alert                  # send an email to admin
  if cpu is greater than 80% for 3 cycles then restart                # hung process?
  if loadavg(5min) greater than 10 for 8 cycles then restart          # bad, bad, bad
  if 20 restarts within 20 cycles then timeout                         # something is wrong, call the sys-admin
  group mongrel

check process mongrel_<%= @username %>_5002
  with pidfile /data/<%= @username %>/shared/log/mongrel.5002.pid
  start program = "/usr/bin/mongrel_rails cluster::start -C /data/<%= @username %>/current/config/mongrel_cluster.yml --clean --only 5002"
  stop program = "/usr/bin/mongrel_rails cluster::stop -C /data/<%= @username %>/current/config/mongrel_cluster.yml --clean --only 5002"
  if totalmem is greater than 110.0 MB for 1 cycles then restart       # eating up memory?
  if cpu is greater than 50% for 2 cycles then alert                  # send an email to admin
  if cpu is greater than 80% for 3 cycles then restart                # hung process?
  if loadavg(5min) greater than 10 for 8 cycles then restart          # bad, bad, bad
  if 20 restarts within 20 cycles then timeout                         # something is wrong, call the sys-admin
  group mongrel

# check process sphinx_<%= @username %>_3312
#   with pidfile /data/<%= @username %>/shared/log/searchd.pid
#   start program = "/etc/init.d/searchd start"
#   stop program = "/etc/init.d/searchd stop"
#   group sphinx

# check process memcache_<%= @username %>_11211
#   with pidfile /data/<%= @username %>/shared/log/memcached.11211.pid
#   start program = "/etc/init.d/memcached start"
#   stop program = "/etc/init.d/memcached stop"
#   group memcached
